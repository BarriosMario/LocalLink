<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="LocalLink.Vistas.Profile.ProfileDetailsPage"
             Shell.FlyoutBehavior="Disabled"
             Shell.NavBarIsVisible="True"
             BackgroundColor="White">
    <Grid>
        <ScrollView>
            <VerticalStackLayout Padding="25" Spacing="20">

                <!-- Imagen Perfil -->
                <Frame WidthRequest="120"
                       HeightRequest="120"
                       CornerRadius="60"
                       Padding="0"
                       HorizontalOptions="Center"
                       IsClippedToBounds="True"
                       HasShadow="False"
                       BorderColor="DarkCyan">

                    <Image x:Name="ProfileImage"
                           Aspect="AspectFill"
                           Source="default_avatar.png"/>
                </Frame>

                <!-- Username -->
                <Label x:Name="UsernameLabel"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="Black"
                       HorizontalOptions="Center"/>

                <!-- Email -->
                <Label x:Name="EmailLabel"
                       FontSize="16"
                       TextColor="Gray"
                       HorizontalOptions="Center"/>

                <!-- BotÃ³n editar -->
                <Button Text="Editar Perfil"
                        BackgroundColor="DarkCyan"
                        TextColor="White"
                        CornerRadius="10"
                        Clicked="OnEditProfileClicked"/>
            </VerticalStackLayout>
        </ScrollView>

        <!-- ðŸ”¥ OVERLAY FULLSCREEN -->
        <Grid x:Name="EditOverlay"
              IsVisible="False"
              BackgroundColor="#80000000"
              InputTransparent="False">

            <!-- Fondo clickeable -->
            <BoxView BackgroundColor="Transparent">
                <BoxView.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnCancelEditClicked"/>
                </BoxView.GestureRecognizers>
            </BoxView>

            <!-- Panel blanco que ocupa TODA la pantalla -->
            <Frame x:Name="EditModal"
                   BackgroundColor="White"
                   CornerRadius="25"
                   Padding="20"
                   VerticalOptions="End"
                   HasShadow="True"
                   TranslationY="400">

                <VerticalStackLayout Spacing="18">

                    <!-- Foto -->
                    <Frame WidthRequest="120"
                               HeightRequest="120"
                               CornerRadius="60"
                               Padding="0"
                               HorizontalOptions="Center"
                               IsClippedToBounds="True"
                               HasShadow="False"
                               BorderColor="DarkCyan">

                        <Image x:Name="EditProfileImage"
                                   Aspect="AspectFill"/>
                    </Frame>

                    <!-- Cambiar foto -->
                    <Button Text="Cambiar foto de perfil"
                                BackgroundColor="Transparent"
                                TextColor="DarkCyan"
                                HorizontalOptions="Center"
                                Clicked="OnChangePhotoClicked"/>

                    <!-- LÃ­nea -->
                    <BoxView HeightRequest="1"
                                 BackgroundColor="#DDDDDD"/>

                    <!-- Username -->
                    <Entry x:Name="EditUsernameEntry"
                               Placeholder="Nombre de usuario"
                               TextColor="Black"/>

                    <!-- Botones -->
                    <Grid ColumnDefinitions="*,*"
                              Margin="0,10,0,0">

                        <Button Text="Cancelar"
                                    BackgroundColor="Transparent"
                                    TextColor="Gray"
                                    Clicked="OnCancelEditClicked"/>

                        <Button Grid.Column="1"
                                    Text="Guardar"
                                    BackgroundColor="Transparent"
                                    TextColor="DarkCyan"
                                    Clicked="OnSaveEditClicked"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>
        </Grid>
    </Grid>
</ContentPage>